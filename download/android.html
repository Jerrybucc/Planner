<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" type="text/css" href="../bootstrap/css/bootstrap.css"/>
	<script type="text/javascript" src="../javascripts/jquery.js"></script>
	<script type="text/javascript" src="../bootstrap/js/bootstrap.js"></script>
	<title>Plan Assist Tool</title>
	<style type="text/css">
	h1{text-align: center;}
	.inline{display: inline;}
	.btnimg{color: white;background-color: #51A351;border-radius: 4px;font-size: 14px;font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;padding: 4px 12px;}
	@media print{#printHide{display: none;}}
	</style>
</head>
<body>
<div id="printHide">
<div class="container">
	<blockquote>
		<b class="lead">Plan Assist Tool</b>
		<small>NBFLS hacker community Jerrybucc</small>
	</blockquote>
	
	<button id="create" class="btn btn-success">Get Plan Table</button>

	<div class="btn-group">
		<button class="btn btn-success dropdown-toggle" data-toggle="dropdown">Download My plan<span class="caret"></span></button>
		<ul class="dropdown-menu">
			<li><a id="dPDF" tabindex="-1" href="javascript:window.print()">Download by PDF</a></li>
			<li><a id="dExcel" tabindex="-1" href="javascript:alert('This function is not available, yet!')">Download by Excel</a></li>
			<li class="divider"></li>
			<li><a id="nod" tabkeindex="-1" href="javascript:void(0)">I don't want to download</a></li>
		</ul>
	</div>

	<div class="well">
		<span class="lead">First: Read and fullfill the following statements step by step!</span><br/>
		<span>Plan name</span>
			<input id="planName" type="text" placeholder="e.g. MyPlan" data-provide="typehead" autocoplete="off" data-minLength="1" /><br/>
		<span>Tag name:</span>
			<input id="tagName" type="text" placeholder="e.g. chapter list section test no." data-provide="typehead" autocoplete="off" data-minLength="1" data-source="["list","chapter","section","test","no."]" /><br/>
		<span>Font size:</span>
			<div class="btn-group" data-toggle="btn-checkbox">
				<button class="btn btn-success">small</button>
				<button class="btn btn-success">middle</button>
				<button class="btn btn-success">large</button>
			</div><br/>
		<span>Start with:</span>
			<input id="startDate" type="text" placeholder="yyyy-mm-dd" data-provide="typehead" autocoplete="off" data-minLength="1" /><br/>
		<span>How much do you learn per day?</span>
			<input id="listPerDay" type="text" placeholder="e.g. 2" data-provide="typehead" autocoplete="off" data-minLength="1" /><br/>
		<span>What is the total amount of your book?</span>
			<input id="total" type="text" placeholder="e.g. 45" data-provide="typehead" autocoplete="off" data-minLength="1" /><br/>
		<span class="lead">Second: Click the above <p class="inline btnimg">Get Plan Table</p> button to form your own plan!</span>
	</div>
</div>
</div>
<div class="container">
	<div class="well">
		<!-- container -->
			<h1>Sample</h1>
		<div id="output">
			<table id="week" class="table">
					<td>Sun</td>
					<td>Mon</td>
					<td>Tue</td>
					<td>Wed</td>
					<td>Thr</td>
					<td>Fri</td>
					<td>Sat</td>
			</table>
			<table id="table" class="table">
				<tr>
					<td>11/23</td>
					<td>11/24<br/>&nbsp;&nbsp;L 1~2<br/>*L 1~2</td>
					<td>11/25<br/>&nbsp;&nbsp;L 3~4<br/>*L 1~2<br/>*L 3~4</td>
					<td>11/26<br/>&nbsp;&nbsp;L 5~6<br/>*L 3~4<br/>*L 5~6</td>
					<td>11/27<br/>&nbsp;&nbsp;L 7~8<br/>*L 1~2<br/>*L 5~6<br/>*L 7~8</td>
					<td>11/28<br/>&nbsp;&nbsp;L 9~10<br/>*L 3~4<br/>*L 7~8<br/>*L 9~10</td>
					<td>11/29<br/>&nbsp;&nbsp;L 11~12<br/>*L 5~6<br/>*L 9~10<br/>*L 11~12</td>
				</tr>
				<tr>
					<td>11/30<br/>&nbsp;&nbsp;L 13~14<br/>*L 7~8<br/>*L 11~12<br/>*L 13~14</td>
					<td>12/1<br/>&nbsp;&nbsp;L 15~16<br/>*L 1~2<br/>*L 9~10<br/>*L 13~14<br/>*L 15~16</td>
					<td>12/2<br/>&nbsp;&nbsp;L 17~18<br/>*L 3~4<br/>*L 11~12<br/>*L 15~16<br/>*L 17~18</td>
					<td>12/3<br/>&nbsp;&nbsp;L 19~20<br/>*L 5~6<br/>*L 13~14<br/>*L 17~18<br/>*L 19~20</td>
					<td>12/4<br/>&nbsp;&nbsp;L 21~22<br/>*L 7~8<br/>*L 15~16<br/>*L 19~20<br/>*L 21~22</td>
					<td>12/5<br/>&nbsp;&nbsp;L 23~24<br/>*L 9~10<br/>*L 17~18<br/>*L 21~22<br/>*L 23~24</td>
					<td>12/6<br/>&nbsp;&nbsp;L 25~26<br/>*L 11~12<br/>*L 19~20<br/>*L 23~24<br/>*L 25~26</td>
				</tr>
				<tr>
					<td>12/7<br/>&nbsp;&nbsp;L 27~28<br/>*L 13~14<br/>*L 21~22<br/>*L 25~26<br/>*L 27~28</td>
					<td>12/8<br/>&nbsp;&nbsp;L 29~30<br/>*L 1~2<br/>*L 15~16<br/>*L 23~24<br/>*L 27~28<br/>*L 29~30</td>
					<td>12/9<br/>&nbsp;&nbsp;L 31~32<br/>*L 3~4<br/>*L 17~18<br/>*L 25~26<br/>*L 29~30<br/>*L 31~32</td>
					<td>12/10<br/>&nbsp;&nbsp;L 33~34<br/>*L 5~6<br/>*L 19~20<br/>*L 27~28<br/>*L 31~32<br/>*L 33~34</td>
					<td>12/11<br/>&nbsp;&nbsp;L 35~36<br/>*L 7~8<br/>*L 21~22<br/>*L 29~30<br/>*L 33~34<br/>*L 35~36</td>
					<td>12/12<br/>&nbsp;&nbsp;L 37~38<br/>*L 9~10<br/>*L 23~24<br/>*L 31~32<br/>*L 35~36<br/>*L 37~38</td>
					<td>12/13<br/>&nbsp;&nbsp;L 39~40<br/>*L 11~12<br/>*L 25~26<br/>*L 33~34<br/>*L 37~38<br/>*L 39~40</td>
				</tr>
				<tr>
					<td>12/14<br/>&nbsp;&nbsp;L 41~42<br/>*L 13~14<br/>*L 27~28<br/>*L 35~36<br/>*L 39~40<br/>*L 41~42</td>
					<td>12/15<br/>*L 15~16<br/>*L 29~30<br/>*L 37~38<br/>*L 41~42</td>
					<td>12/16<br/>*L 17~18<br/>*L 31~32<br/>*L 39~40</td>
					<td>12/17<br/>*L 19~20<br/>*L 33~34<br/>*L 41~42</td>
					<td>12/18<br/>*L 21~22<br/>*L 35~36</td>
					<td>12/19<br/>*L 1~2<br/>*L 23~24<br/>*L 37~38</td>
					<td>12/20<br/>*L 3~4<br/>*L 25~26<br/>*L 39~40</td>
				</tr>
				<tr>
					<td>12/21<br/>*L 5~6<br/>*L 27~28<br/>*L 41~42</td>
					<td>12/22<br/>*L 7~8<br/>*L 29~30</td>
					<td>12/23<br/>*L 9~10<br/>*L 31~32</td>
					<td>12/24<br/>*L 11~12<br/>*L 33~34</td>
					<td>12/25<br/>*L 13~14<br/>*L 35~36</td>
					<td>12/26<br/>*L 15~16<br/>*L 37~38</td>
					<td>12/27<br/>*L 17~18<br/>*L 39~40</td>
				</tr>
				<tr>	
					<td>12/28<br/>*L 19~20<br/>*L 41~42</td>
					<td>12/29<br/>*L 21~22</td>
					<td>12/30<br/>*L 23~24</td>
					<td>12/31<br/>*L 25~26</td>
					<td>1/1<br/>*L 27~28</td>
					<td>1/2<br/>*L 29~30</td>
					<td>1/3<br/>*L 31~32</td>
				</tr>
				<tr>
					<td>1/4<br/>*L 33~34</td>
					<td>1/5<br/>*L 35~36</td>
					<td>1/6<br/>*L 37~38</td>
					<td>1/7<br/>*L 39~40</td>
					<td>1/8<br/>*L 41~42</td>
				</tr>			
			</table>
		</div>
		<!-- container -->
	</div>
</div>
	<!-- js test -->

<script>
	$("#startDate").val(new Date().toJSON().slice(0,10));
	$("#create").click(function create() {
		var tagName=$("#tagName").val();
		var startDate=$("#startDate").val();
		var listPerDay=$("#listPerDay").val()-0;
		var total=$("#total").val()-0;
		var weekday=new Date(startDate).getDay();
		var firstLineSunday=new Date(new Date(startDate)-weekday*86400000);
		var table=$("#table").empty();
		var isNum = new RegExp("^(0|[1-9][0-9]*)$");

		$("#week tr").empty();
		$("#week tr").append("<td>Sun</td><td>Mon</td><td>Tue</td><td>Wed</td><td>Thr</td><td>Fri</td><td>Sat</td>");
		$("h1").text($("#planName").val())
			//exceptions
			if (listPerDay<=0){
				alert("You need learn at least 1 section of your book!");
				return false;
			}
			if (listPerDay>total){
				alert("You can't learn sections out of the range of your book!");
				return false;
			}
			if (parseInt(listPerDay)!=listPerDay||parseInt(total)!=total){
				alert("Your Sections should be Integer");
				return false;
			}
			if (isNum.test(tagName)){
				if(confirm("To make the table neat and clean, You probably don\'t use number as your tag name.\nAre you sure You still want to use "+tagName+" as your tag name?")){
					tagName=$("#tagName").val();	
				}else{
					return false;
				}
			}
			//exceptions
			for (var i = 0; i<7; i++) {
				currentDay=new Date(firstLineSunday-0+i*86400000);
				if (i==0) $("#table").append("<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>"); 
				$("table tr td").slice(i,i+1).append("<br/>"+(currentDay.getMonth()-0+1)+"/"+currentDay.getDate());
				if (i==6) break;
			};

			for (var i = 7,x=0,l=total/listPerDay+25+weekday; i<l; i++) {
				currentDay=new Date(firstLineSunday-0+i*86400000);
				if (i%7==0) $("#table").append("<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>"); 
				$("#table tr td").slice(x,x+1).append((currentDay.getMonth()-0+1)+"/"+currentDay.getDate());
				x++;
			};


		var planName=[];
		for (var i = 0,l=total/listPerDay; i <l; i++) {
			tmp=[];
			for (var j = 1; j <= listPerDay; j++) {
				k=i*listPerDay+j;
				if (k>total) break;
				tmp.push(k);
			};
			if(tmp.length==1){
				str=tmp[0]
			} else {
				str=tmp.shift()+"~"+tmp.pop();
			}
			planName.push(str);
		};
		for (var i = 0,l=planName.length; i < l; i++) {
			// alert("list1");
			$("table tr").children().eq(weekday+i).append("<br>&nbsp;&nbsp;"+tagName+" "+planName[i]);
		};
		var planName=[];
		for (var i = 0,l=total/listPerDay; i <l; i++) {
			tmp=[];
			for (var j = 1; j <= listPerDay; j++) {
				k=i*listPerDay+j;
				if (k>total) break;
				tmp.push(k);
			};
			if(tmp.length==1){
				str=tmp[0]
			} else {
				str=tmp.shift()+"~"+tmp.pop();
			}

			planName.push(str);
		};
		for (var i = 0,l=planName.length; i < l; i++) {
			// alert("list2+");
			$('table tr').children().eq(weekday+i).append("<br>*"+tagName+" "+planName[i]);
			$('table tr').children().eq(weekday+i+1).append("<br>*"+tagName+" "+planName[i]);
			$('table tr').children().eq(weekday+i+3).append("<br>*"+tagName+" "+planName[i]);
			$('table tr').children().eq(weekday+i+7).append("<br>*"+tagName+" "+planName[i]);
			$('table tr').children().eq(weekday+i+14).append("<br>*"+tagName+" "+planName[i]);
			$('table tr').children().eq(weekday+i+25).append("<br>*"+tagName+" "+planName[i]);
			
		};
	});
	// excel output
	// $("#dExcel").click(function (){  
 //          var winname = window.open('', '_blank', 'top=10000');  
 //          var strHTML = document.all.table.innerHTML;  
 //          winname.document.open('text/html', 'replace');  
 //          winname.document.writeln(strHTML);  
 //          winname.document.execCommand('saveas','','excel.xls');  
 //          winname.close();
 //          });
</script>

	<!-- js test -->
</body>
</html>
